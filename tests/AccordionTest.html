<html>
<body>
<canvas id="canvas" width="1024" height="600" style="background-color: #CCC"></canvas>
<div id="root">
ROOT
</div>
</body>
<script>
var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");

function Menu(parent, id, x, y, w, h, visible) {
  this.x = x;
  this.y = y;
  this.w = w;
  this.h = h;
  this.id = id; 
  this.visible = visible;
  this.parent = parent;
  this.root = false;
  this.submenu = new Array(); // must be array of Menu()
  
  this.getHeights = function() {
    var obj = this.submenu;
    var height = 0;
    
    if (obj.length > 0) {
      for (var i=0; i < obj.length; i++) {
        if (obj[i].visible) {
          height += obj[i].h;
          height += obj[i].getHeights();
        }
      }
    }
    return height;
  };

  this.draw1 = function() {
    // Draw Root
    if (this.root) {
    } else {
      // Draw Itself
      var parentY = this.parent.y;

      var x = this.x;
      var y = this.y - this.h - parent.getHeights();
      // To get Y
      // Get height of it's visible children
      // Get height of parent children
      // SCRAPPED - Get height of parent children's visible children
      
      var w = this.w;
      var h = this.h;
      var id = this.id;
      
      console.log("x: {1} y: {2} w: {3} h: {4}\t {0}".format(id, x, y, w, h));

      ctx.fillStyle = "#F00";
      ctx.fillRect(x, y, w, h);
    }
    
    // Draw Children
    if (this.submenu.length > 0) {
      for (var i=0; i < this.submenu.length; i++){
        this.submenu[i].draw(offset);
      }
    }
  };
  
  this.draw = function(x, y) {
    // var x = this.x;
    // var y = offset;
    var w = this.w;
    var h = this.h;
    
    // Draw
    ctx.fillStyle = "#F00";
    ctx.fillRect(x-1, y-1, w+2, h+2);
    
    ctx.fillStyle = "#000";
    
    if (this.id == "child0" || this.id == "child1" || this.id == "child2")
      ctx.fillStyle = "#FFF";
      
    ctx.fillRect(x, y, w, h);
    
    var submenu = this.submenu;
    var totalHeight = 0;
    var childrenHeight = y + h;
    
    for (var i=0; i < submenu.length; i++) {
      submenu[i].draw(x, totalHeight);
      totalHeight += submenu[i].h;
    }
    
    console.log(this.id + " " + y);
    
    return totalHeight;
  };
  
  this.add = function(id, w, h, visible) {
    var x = this.x;
    var y = this.y;
    
    this.submenu.push(
      new Menu(this, id, x, y, w, h, visible));
  };
}

var rootMenu = new Menu(0, "root", 0, 0, 167, 40, true);
rootMenu.root = true;

rootMenu.add("description", 167, 40, false);
rootMenu.add("resources", 167, 40, false);
rootMenu.add("buildings", 167, 40, true);
rootMenu.add("units", 167, 40, true);

rootMenu.submenu[0].add("child0", 167, 40, true);
rootMenu.submenu[0].add("child1", 167, 40, true);
rootMenu.submenu[0].add("child2", 167, 40, true);

rootMenu.draw(0,0);

String.prototype.format = function() {
  var args = arguments;
  return this.replace(/{(\d+)}/g, function(match, number) { 
    return typeof args[number] != 'undefined'
      ? args[number]
      : match
    ;
  });
};
</script>
</html>